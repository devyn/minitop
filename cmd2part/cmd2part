#!/usr/bin/env ruby
require 'rubygems'
require 'zip/zip'
require 'zip/zipfilesystem'
require 'yaml'

zip = Zip::ZipFile.open("#{ARGV[0]}.part", true)
zip.file.open("description.yml", 'w') do |f|
    f.write({'name' => ARGV[0]}.to_yaml)
end
zip.file.open("part.erb", 'w') do |f|
    f.write <<-EOF
    <!-- generated by cmd2part -->
    <div style="font-weight: bold; font-color: white">Result of <span style="font-family: monospace"><%= h "#{ARGV[1].gsub('"', '\"')}" %></span>:</div>
    <div style="font-family: monospace"><%= h(`#{ARGV[1].gsub('`', '\`')}`).gsub("\n", "<br/>") %></div>
    EOF
end
zip.close

